(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-post-detail-post-detail"],{"0edd":function(t,e,i){"use strict";var o=i("f577"),n=i.n(o);n.a},"4c17":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"content",attrs:{id:"post-detail"}},[i("v-uni-view",{staticClass:"post-detail"},[i("v-uni-view",{staticClass:"show-user"},[i("v-uni-image",{staticClass:"user-head-img",attrs:{src:t.post.user.headImg,"data-userId":t.post.user.id},on:{click:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.goUserData(e)}}}),i("v-uni-view",{staticClass:"show-user-right"},[i("v-uni-view",{staticClass:"show-user-right-top"},[i("v-uni-view",{staticClass:"user-info"},[i("v-uni-view",{staticClass:"user-name"},[t._v(t._s(t.post.user.name))]),t.post.user.isCertified?i("v-uni-view",{staticClass:"has-certified"},[t._v("已认证")]):i("v-uni-view",{staticClass:"not-certified"},[t._v("未认证")])],1),i("v-uni-view",{staticClass:"post-points"},[t._v("$"+t._s(t.post.points))])],1),i("v-uni-view",{staticClass:"post-publish-time"},[t._v(t._s(t.post.publishTime))])],1)],1),i("v-uni-view",{staticClass:"post-title"},[t._v(t._s(t.post.title))]),i("v-uni-view",{staticClass:"devide-line"}),i("v-uni-view",{staticClass:"post-content"},[i("v-uni-text",[t._v(t._s(t.post.content))])],1),i("v-uni-view",{staticClass:"operation-box"},[i("v-uni-image",{staticClass:"operation-icon",attrs:{src:"/static/icons/collect.png"},on:{click:function(e){e=t.$handleEvent(e),t.collectPost(e)}}}),i("v-uni-image",{staticClass:"operation-icon",attrs:{src:"/static/icons/comment2.png"},on:{click:function(e){e=t.$handleEvent(e),t.showAddCommentBox(e)}}}),i("v-uni-view",{staticClass:"operation-times"},[t._v(t._s(t.post.commentNum))]),i("v-uni-image",{staticClass:"operation-icon",attrs:{src:"/static/icons/give-a-like.png"},on:{click:function(e){e=t.$handleEvent(e),t.approvalPost(e)}}}),i("v-uni-view",{staticClass:"operation-times"},[t._v(t._s(t.post.approvalNum))]),i("v-uni-image",{staticClass:"operation-icon",attrs:{src:"/static/icons/report.png"},on:{click:function(e){e=t.$handleEvent(e),t.reportPost(e)}}}),i("v-uni-view",{staticClass:"operation-times"},[t._v(t._s(t.post.reportNum))])],1)],1),i("v-uni-view",{staticClass:"post-devide-line"}),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.showAddComment,expression:"showAddComment"}],staticClass:"add-comment-box"},[i("v-uni-textarea",{staticClass:"add-comment-box-textarea",attrs:{placeholder:"输入评论...","placeholder-class":"add-comment-box-textarea-pr"},model:{value:t.commentEnter,callback:function(e){t.commentEnter=e},expression:"commentEnter"}}),i("v-uni-view",{staticClass:"add-comment-box-bottom"},[i("v-uni-view",{staticStyle:{flex:"1"}}),i("v-uni-image",{staticClass:"operation-icon",attrs:{src:"/static/icons/emoji.png"}}),i("v-uni-image",{staticClass:"operation-icon",attrs:{src:"/static/icons/pic.png"}}),i("v-uni-view",{staticClass:"add-comment-box-bottom-submit",on:{click:function(e){e=t.$handleEvent(e),t.addComment(e)}}},[t._v("评论")])],1)],1),i("v-uni-view",{on:{click:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.hideAddCommentBox(e)}}},[t._l(t.post.comments,function(e,o){return[i("v-uni-view",{key:e.id+"_0",staticClass:"comment-item",attrs:{"data-index":o,id:"comment-"+e.id}},[i("v-uni-view",{staticClass:"show-user"},[i("v-uni-image",{staticClass:"user-head-img",attrs:{src:e.user.headImg,"data-userId":e.user.id},on:{click:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.goUserData(e)}}}),i("v-uni-view",{staticClass:"show-user-right"},[i("v-uni-view",{staticClass:"show-user-right-top"},[i("v-uni-view",{staticClass:"user-info"},[i("v-uni-view",{staticClass:"user-name"},[t._v(t._s(e.user.name))]),e.user.isCertified?i("v-uni-view",{staticClass:"has-certified"},[t._v("已认证")]):i("v-uni-view",{staticClass:"not-certified"},[t._v("未认证")])],1),e.helpOk?i("v-uni-image",{staticClass:"help-ok",attrs:{src:"/static/icons/help-ok.png"}}):i("v-uni-image",{staticClass:"help-not-ok",attrs:{src:"/static/icons/help-not-ok.png","data-index":o},on:{click:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.setHelpOk(e)}}})],1),i("v-uni-view",{staticClass:"post-publish-time"},[t._v(t._s(e.publishTime))])],1)],1),i("v-uni-view",{staticClass:"comment-content"},[t._v(t._s(e.content))]),i("v-uni-view",{staticClass:"devide-line"})],1)]})],2)],1)},n=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return n})},a40b:function(t,e,i){"use strict";function o(t){var e={year:"%n% 年前",month:"%n% 月前",day:"%n% 天前",hour:"%n% 小时前",minute:"%n% 分钟前",second:"%n% 秒前"},i=Date.now(),o=Math.floor((i-t)/1e3)+1,n=Math.floor(o/60),s=Math.floor(n/60),a=Math.floor(s/24),r=Math.floor(a/30),c=Math.floor(r/12),l="",d=0;return c>0?(l="year",d=c):r>0?(l="month",d=r):a>0?(l="day",d=a):s>0?(l="hour",d=s):n>0?(l="minute",d=n):(l="second",d=0===o?o=1:o),e[l].replace("%n%",d)}function n(t,e){return t.length<e?t:t.substring(0,e)+"..."}Object.defineProperty(e,"__esModule",{value:!0}),e.friendlyDate=o,e.cutString=n},aac9:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/*每个页面公共css */.content[data-v-2223b0b6]{background:#fefefe;border-top:1px solid #e9e9e9}.devide-line[data-v-2223b0b6],.post-devide-line[data-v-2223b0b6]{width:100%;height:1px;background:#e9e9e9}.normal-icon-box[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-top:%?10?%;width:%?120?%}.normal-icon-box-icon[data-v-2223b0b6]{width:%?36?%;height:%?36?%;margin:%?7?% %?10?%}.normal-icon-box-text[data-v-2223b0b6]{max-width:%?60?%;font-size:%?26?%;line-height:%?50?%;color:#666;text-align:left;font-weight:400}.big-icon-box[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;width:%?120?%}.big-icon-box-icon[data-v-2223b0b6]{width:%?34?%;height:%?34?%;padding:%?3?% 0;margin-right:%?5?%}.big-icon-box-text[data-v-2223b0b6]{max-width:%?75?%;font-size:%?30?%;line-height:%?40?%;color:#343131;text-align:left;font-weight:400}.normal-icon[data-v-2223b0b6]{width:%?36?%;height:%?36?%;margin:%?7?% %?10?%}.large-icon[data-v-2223b0b6]{width:%?45?%;height:%?45?%;margin:%?7?% %?10?%}.post-detail[data-v-2223b0b6]{width:%?750?%;padding:0 %?15?%;-webkit-box-sizing:border-box;box-sizing:border-box}.show-user[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:%?730?%;-webkit-box-sizing:border-box;box-sizing:border-box}.user-head-img[data-v-2223b0b6]{width:%?100?%;height:%?100?%;border-radius:50%;margin:%?10?% 0;margin-right:%?25?%}.show-user-right[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:%?15?% 0}.show-user-right-top[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:%?600?%}.user-info[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:left;-webkit-justify-content:left;-ms-flex-pack:left;justify-content:left;width:%?450?%}.user-name[data-v-2223b0b6]{font-size:%?32?%;line-height:%?45?%;color:#343131;text-align:left;font-weight:700;padding-right:%?10?%}.has-certified[data-v-2223b0b6],.not-certified[data-v-2223b0b6]{background:#09f;font-size:%?25?%;line-height:%?40?%;color:#fefefe;text-align:center;font-weight:700;border-radius:%?5?%;margin-bottom:%?6?%;width:%?105?%}.not-certified[data-v-2223b0b6]{background:#ccc}.post-points[data-v-2223b0b6]{font-size:%?32?%;line-height:%?45?%;color:#fc0;text-align:left;font-weight:700}.post-publish-time[data-v-2223b0b6]{font-size:%?23?%;line-height:%?45?%;color:#343131;text-align:left;font-weight:400}.post-title[data-v-2223b0b6]{width:%?720?%;padding:%?10?% 0;font-size:%?38?%;line-height:%?45?%;color:#000;text-align:left;font-weight:700}.post-content[data-v-2223b0b6]{width:%?680?%;word-break:break-all;padding:%?45?% %?20?% %?60?% %?20?%;font-size:%?28?%;line-height:%?45?%;color:#343131;text-align:left;font-weight:400}.operation-box[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;width:%?720?%}.operation-icon[data-v-2223b0b6]{width:%?45?%;height:%?45?%;margin:%?7?% %?10?%;margin:%?7?% %?5?% %?7?% %?25?%}.operation-icon-comment[data-v-2223b0b6]{width:%?35?%;height:%?35?%;margin:%?7?% %?10?%;margin:%?12?% %?5?% %?12?% %?25?%}.operation-times[data-v-2223b0b6]{font-size:%?34?%;line-height:%?45?%;color:#a9a9a9;text-align:center;font-weight:400;margin:%?7?% %?5?%}.add-comment-box[data-v-2223b0b6]{margin:%?10?% %?15?%;width:%?720?%;border:1px solid #bfbfbf;border-radius:%?10?%}.add-comment-box-textarea[data-v-2223b0b6]{width:%?680?%;height:%?240?%;padding:%?10?% %?20?%;font-size:%?32?%;line-height:%?45?%;color:#343131;text-align:left;font-weight:400}.add-comment-box-textarea-pr[data-v-2223b0b6]{font-size:%?32?%;line-height:%?45?%;color:#a9a9a9;text-align:left;font-weight:400}.add-comment-box-bottom[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:%?10?% %?20?%}.add-comment-box-bottom-submit[data-v-2223b0b6]{font-size:%?32?%;line-height:%?45?%;color:#fefefe;text-align:center;font-weight:400;height:%?45?%;padding:%?2?% %?15?%;border-radius:%?5?%;background:#09f;margin:%?5?% %?5?% %?5?% %?25?%}.post-devide-line[data-v-2223b0b6]{background:#c9c9c9;margin:%?20?% 0}.comment-item[data-v-2223b0b6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:%?5?% %?15?%;width:%?730?%}.help-not-ok[data-v-2223b0b6],.help-ok[data-v-2223b0b6]{width:%?45?%;height:%?45?%;margin:%?7?% %?10?%;margin:0 %?15?%}.comment-content[data-v-2223b0b6]{width:%?680?%;font-size:%?30?%;line-height:%?45?%;color:#343131;text-align:left;font-weight:400;padding:%?30?% %?25?% %?45?% %?25?%}',""])},e32d:function(t,e,i){"use strict";i.r(e);var o=i("4c17"),n=i("e352");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("0edd");var a=i("2877"),r=Object(a["a"])(n["default"],o["a"],o["b"],!1,null,"2223b0b6",null);e["default"]=r.exports},e352:function(t,e,i){"use strict";i.r(e);var o=i("f472"),n=i.n(o);for(var s in o)"default"!==s&&function(t){i.d(e,t,function(){return o[t]})}(s);e["default"]=n.a},f472:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i("a40b"),n={data:function(){return{showAddComment:!1,commentEnter:"",postDetail:{},post:{points:0}}},methods:{showAddCommentBox:function(){this.showAddComment=!0},hideAddCommentBox:function(){this.showAddComment=!1},goUserData:function(t){console.log(t.currentTarget.dataset.userid,this.$store.state.userInfo.id),t.currentTarget.dataset.userId!=this.$store.state.userInfo.id&&uni.navigateTo({url:"../../otherUsers/otherUsers?userId="+t.currentTarget.dataset.userid})},addComment:function(){var t=this,e=this.$api.urls.addComment,i={postId:this.post.id,commentContent:this.commentEnter};console.log(i),this.$api.req.post(e,i,function(e){console.log(e),t.commentEnter="",t.updateComments(),t.hideAddCommentBox()})},updateComments:function(){var t=this;this.post.comments=[];var e=this.$api.urls.getAllComments+this.post.id,i={};this.$api.req.get(e,i,function(e){console.log(e);var i=t.post.helpUserId,n=[];e.data&&(n=e.data.map(function(t){return{id:t.commentId,user:{id:t.userId,headImg:t.headImageUrl,isCertified:!1,name:t.commentUserName},publishTime:(0,o.friendlyDate)(new Date(t.commentTime.replace(/\-/g,"/").replace(/\T/g," ").substring(0,19)).getTime()),content:t.commentContent,helpOk:t.userId==i}}),t.post.comments=n,t.checkCertified())})},checkCertified:function(){var t=this,e=this.$api.urls.checkCertified,i=[];i.push(this.post.user.id),this.post.comments.map(function(t){i.includes(t.user.id)||i.push(t.user.id)});var o={userIds:i};console.log(o),this.$api.req.put(e,o,function(e){for(var o in console.log(e),i){t.post.user.id==i[o]&&(t.post.user.isCertified=e.data[o]);var n=!0,s=!1,a=void 0;try{for(var r,c=t.post.comments[Symbol.iterator]();!(n=(r=c.next()).done);n=!0){var l=r.value;l.user.id==i[o]&&(l.user.isCertified=e.data[o])}}catch(d){s=!0,a=d}finally{try{n||null==c.return||c.return()}finally{if(s)throw a}}}console.log(t.post)})},approvalPost:function(){var t=this,e=this.$api.urls.approvalPost,i={postId:this.post.id};this.$api.req.post(e,i,function(e){console.log(e),0==e.code?(uni.showToast({icon:"none",title:e.data}),"点赞成功"==e.data?t.post.approvalNum++:"取消点赞"==e.data&&t.post.approvalNum--):uni.showToast({icon:"none",title:e.msg})})},reportPost:function(){var t=this,e=this.$api.urls.reportPost,i={postId:this.post.id,reportDes:"nonenonenonenonenonenonenone"};this.$api.req.post(e,i,function(e){0==e.code?(uni.showToast({icon:"none",title:"举报成功"}),t.post.reportNum++):uni.showToast({icon:"none",title:e.msg})})},collectPost:function(){var t=this,e=this.$api.urls.collectPost,i={postId:this.post.id};this.$api.req.post(e,i,function(e){0==e.code?(uni.showToast({icon:"none",title:"收藏成功"}),t.post.collectNum++):uni.showToast({icon:"none",title:e.msg})})},setHelpOk:function(t){var e=t.currentTarget.dataset.index,i=this.post.comments[e];if(console.log(e,this.post.helpUserId,this.$store.state.userInfo.id,i.user.id,this.post.user.id),-1!=this.post.helpUserId)uni.showToast({icon:"none",title:"帖子已经结贴了哦"});else if(this.$store.state.userInfo.id!=this.post.user.id)uni.showToast({icon:"none",title:"非帖主不能结贴"});else if(i.user.id==this.post.user.id)uni.showToast({icon:"none",title:"不能给自己设置帮助成功哦"});else if(0==this.post.points)uni.showToast({icon:"none",title:"积分为0不能设置帮助成功哦"});else{var o=this;uni.showModal({title:"设置帮助成功",content:"您确定选择"+i.user.name+"帮助成功回答吗？他将获得所有帖子积分。",success:function(t){if(t.confirm){var e=o.$api.urls.submitPost,n={postId:o.post.id,submitCommentId:i.id};o.$api.req.post(e,n,function(t){uni.showToast({title:"结贴成功！"}),o.getPostDetail()})}}})}},getPostDetail:function(){var t=this,e=this.$api.urls.getPostDetail+this.postDetail.postId,i={};this.$api.req.get(e,i,function(e){console.log(e);var i=e.data.post.helpUserId,n=[];e.data.comments&&(n=e.data.comments.map(function(t){return{id:t.commentId,user:{id:t.userId,headImg:t.headImageUrl,isCertified:!1,name:t.commentUserName},publishTime:(0,o.friendlyDate)(new Date(t.commentTime.replace(/\-/g,"/").replace(/\T/g," ").substring(0,19)).getTime()),content:t.commentContent,helpOk:t.userId==i}}));var s=e.data.post;t.post={id:s.postId,user:{id:s.userId,headImg:s.headImageUrl,isCertified:!1,name:s.userName},title:s.title,content:s.content,publishTime:(0,o.friendlyDate)(new Date(s.issueTime.replace(/\-/g,"/").replace(/\T/g," ").substring(0,19)).getTime()),points:s.points,comments:n,viewNum:s.viewNum,approvalNum:s.approvalNum,commentNum:s.commentNum,reportNum:s.reportNum,helpUserId:s.helpUserId,helpOk:-1!=s.helpUserId},t.checkCertified()})}},onPullDownRefresh:function(){this.getPostDetail(),setTimeout(function(){uni.stopPullDownRefresh()},1e3)},onLoad:function(t){for(var e in this.postDetail=JSON.parse(t.query),this.postDetail)console.log(e,"---",this.postDetail[e]);this.getPostDetail()}};e.default=n},f577:function(t,e,i){var o=i("aac9");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=i("4f06").default;n("60653969",o,!0,{sourceMap:!1,shadowMode:!1})}}]);